import com.aisadsa.aisadsabackend.core.dto.CreateUserDataDto;
global  com.aisadsa.aisadsabackend.entity.Recommendation recommendation;
import com.aisadsa.aisadsabackend.core.dto.request.CreateUserDataRequest;
import com.aisadsa.aisadsabackend.entity.UserData;

// TODO submit butonu ekle, submit yapınca en son en alttaki değerlendirme yapılmalı. Şuanda her durumda çalışıyor,
// TODO her durumda çalışmamalı!!

// NOT İLİŞKİSEL - EVET VE BÜTÇE YÜKSEKTEKİ COMMENTLERE BAK ve mühendisin beceri seti 3 cevap olabilr 4 yerine
// akış verisi data lake eklenebilr ????
dialect "mvel"

rule "relational - positive"
    when
        UserData(question.questionKey.equals("relational")) and UserData(userData.equals("positive"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        //questionRecommendation.recommendation = "DWH";
        recommendation.recommendationScores.put("DWH", recommendation.recommendationScores.get("DWH") + 50);

end

rule "relational - negative"
    when
        CreateUserDataRequest(questionKey.equals("relational")) and CreateUserDataRequest(userData.equals("negative"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        //questionRecommendation.recommendation = "Modern Data Warehouse, Data Lake, Data Lakehouse, Data Fabric veya Data Mesh";
        recommendation.recommendationScores.put("modernDataWarehouse", recommendation.recommendationScores.get("modernDataWarehouse") +3);
        recommendation.recommendationScores.put("dataLake", recommendation.recommendationScores.get("dataLake") + 40);
        recommendation.recommendationScores.put("dataLakehouse", recommendation.recommendationScores.get("dataLakehouse") +35);
        recommendation.recommendationScores.put("dataFabric", recommendation.recommendationScores.get("dataFabric") +34);
        recommendation.recommendationScores.put("dataMesh", recommendation.recommendationScores.get("dataMesh") +33);

end

rule "Budget - High" /// !!! buraya bütçe yüksek olsa bile orta bütçedekilere 10 puan küçük bütçeye 5 puan tarzı verilebilir
    when
        CreateUserDataDto(question.questionKey.equals("Budget")) and CreateUserDataDto(userData.equals("High"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        //questionRecommendation.recommendation = "DWH veya Data Mesh";
        recommendation.recommendationScores.put("DWH", recommendation.recommendationScores.get("DWH") +26);
        recommendation.recommendationScores.put("dataMesh", recommendation.recommendationScores.get("dataMesh") +25);

end

rule "Budget - Mid"
    when
        CreateUserDataDto(question.questionKey.equals("Budget")) and CreateUserDataDto(userData.equals("Mid"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        //questionRecommendation.recommendation = "Modern Data Warehouse, Data Lakehouse, Data Fabric";
        recommendation.recommendationScores.put("modernDataWarehouse", recommendation.recommendationScores.get("modernDataWarehouse") +35);
        recommendation.recommendationScores.put("dataLakehouse", recommendation.recommendationScores.get("dataLakehouse") +34);
        recommendation.recommendationScores.put("dataFabric", recommendation.recommendationScores.get("dataFabric") +33);
        end


rule "Budget - Low"
    when
        CreateUserDataDto(question.questionKey.equals("Budget")) and CreateUserDataDto(userData.equals("Low"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        //questionRecommendation.recommendation = "Data Lake";
        recommendation.recommendationScores.put("dataLake", recommendation.recommendationScores.get("dataLake") + 40);

end

rule "Streaming Data - Positive"
    when
        CreateUserDataDto(question.questionKey.equals("Streaming Data")) and CreateUserDataDto(userData.equals("Positive"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("dataLakehouse", recommendation.recommendationScores.get("dataLakehouse") + 20);
        recommendation.recommendationScores.put("dataFabric", recommendation.recommendationScores.get("dataFabric") + 20);
        recommendation.recommendationScores.put("dataMesh", recommendation.recommendationScores.get("dataMesh") + 20);
end

rule "Streaming Data - Negative" // data lake eklenebilr !!!!!!,
    when
        CreateUserDataDto(question.questionKey.equals("Streaming Data")) and CreateUserDataDto(userData.equals("Negative"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("DWH", recommendation.recommendationScores.get("DWH") + 20);
        recommendation.recommendationScores.put("modernDataWarehouse", recommendation.recommendationScores.get("modernDataWarehouse") + 20);
end

rule "Data Volume - Low or Mid Scale (1-10TB)"
    when
        CreateUserDataDto(question.questionKey.equals("Data Volume")) and CreateUserDataDto(userData.equals("Low or Mid Scale (1-10TB)"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("DWH", recommendation.recommendationScores.get("DWH") + 35);
        recommendation.recommendationScores.put("modernDataWarehouse", recommendation.recommendationScores.get("modernDataWarehouse") + 35);
end

rule "Data Volume - Large Scale (10 TB - 1 PB)"
    when
        CreateUserDataDto(question.questionKey.equals("Data Volume")) and CreateUserDataDto(userData.equals("Big Scale (10 TB - 1 PB)"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("dataLakehouse", recommendation.recommendationScores.get("dataLakehouse") + 35);
        recommendation.recommendationScores.put("dataFabric", recommendation.recommendationScores.get("dataFabric") + 35);
        recommendation.recommendationScores.put("dataLake", recommendation.recommendationScores.get("dataLake") + 35);
end

rule "Data Volume - Very Large Scale (1 PB and more)"
    when
        CreateUserDataDto(question.questionKey.equals("Data Volume")) and CreateUserDataDto(userData.equals("Very Large Scale (1 PB and more)"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("dataMesh", recommendation.recommendationScores.get("dataMesh") + 55);
end

rule "Engineers Skill Set - Low"
    when
        CreateUserDataDto(question.questionKey.equals("Engineers Skill Set")) and CreateUserDataDto(userData.equals("Low"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("DWH", recommendation.recommendationScores.get("DWH") + 25);
        recommendation.recommendationScores.put("dataLake", recommendation.recommendationScores.get("dataLake") + 25);
end

rule "Engineers Skill Set - Mid"
    when
        CreateUserDataDto(question.questionKey.equals("Engineers skill set")) and CreateUserDataDto(userData.equals("Mid"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("modernDataWarehouse", recommendation.recommendationScores.get("modernDataWarehouse") + 25);
end

rule "Engineers Skill Set - Mid-High"
    when
        CreateUserDataDto(question.questionKey.equals("Engineers Skill Set")) and CreateUserDataDto(userData.equals("Mid-High"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("dataFabric", recommendation.recommendationScores.get("dataFabric") + 25);
        recommendation.recommendationScores.put("dataLakehouse", recommendation.recommendationScores.get("dataLakehouse") + 25);
end

rule "Engineers Skill Set - High"
    when
        CreateUserDataDto(question.questionKey.equals("Engineers Skill Set")) and CreateUserDataDto(userData.equals("High"))  /// !!! diğer soruların cevap da evet olursa ama burada soru id ile gidicez oyle çözeriz
    then
        recommendation.recommendationScores.put("dataMesh", recommendation.recommendationScores.get("dataMesh") + 25);
end

rule "Determine Recommendation"  ///// tek tek soru gondereceksek when submit diye bir buton yaparız o yes olursa yaparız
    when
        eval(true) // Her durumda çalıştırılacak bir kural
    then

        bw = recommendation.getMaxRecommendation();
        recommendation.recommendation = bw;

end
